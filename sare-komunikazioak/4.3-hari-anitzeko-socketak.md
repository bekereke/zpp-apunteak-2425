---
description: ZERBITZARI KONKURRENTEAK
---

# 4.3 Hari anitzeko socketak

Zerbitzari konkurrentea da arkitektura mota bat <mark style="background-color:blue;">bezeroen eskaerak kudeatzeko hari anitz</mark> erabiltzen dituena. Exekuzio hari bakarra duten zerbitzari tradizionaletan eskaera bat prozesatu daiteke aldi berean. Horrela, zerbitzaria eskaera batekin lanpetuta dagoelarik ez du besterik kudeatuko. Eraginkortasun falta hori nabarmengarria da eskaera asko maneiatu behar diren uneetan, erantzun-denborak luzatuz, prozesuak blokeatuz zain daudelarik erantzuna jaso zain, eta abar.&#x20;

Hari anitzeko zerbitzari batean, sartzen den bezero bakoitzari hari bat esleitzen zaio. Hari hauek aldi berean exekutatzen dira eta zerbitzariak eskaera bat baino gehiago aldi berean maneiatzeko aukera dauka. Ondorioz, nabarmen hobetzen dira erantzun ahalmena eta errendimendu orokorra.

Hona hemen zerbitzari konkurrenteen funtzionamenduaren oinarrizko zirriborroa:

1. **Entzuten konexio zain**:
   * Zerbitzariak komunikatzeko **socketa sortzen** du eta **entzuten** hasten da, zain, sartzen diren bezeroen konexioei.
2. **Konexioak onartzea:**
   * Bezero bat konektatzen denean, **zerbitzariak konexioa onartzen** du eta **hari berri bat sortzen** du bezero jakin hori maneiatzeko.
3. **Hariak sortzea:**
   * Bezero-konexio bakoitza hari dedikatu batekin lotuta dago. Zerbitzariak hari berri bat sortzen du sarrerako konexio bakoitzerako, bezero asko aldi berean zerbitzatzea ahalbidetuz.
4. Aldi bereko **eskaeren kudeaketa:**
   * Hariek bezeroen eskaerak kudeatzen dituzte. Zeregin posibleen artean legozke, datu eksaera partikularrak prozesatzea, informazioa berreskuratzea edo zerbitzariaren izaeran oinarritutako beste edozein eragiketa (musika erreproduzitu eta stream bidez itzultzea, jokalarien uneko posizioen egoera eguneratzea, etab.).

Kontuan izan behar da hari anitzek errendimendu-onurak eman ditzaketen arren, haien kudeaketa zuzena erronka ere izango dela programatzailearentzat: hala nola harien sinkronizazioa datu-lasterketak saihesteko, harien arteko komunikazio egokia bermatzeko eta partekatutako baliabideen osotasuna mantentzeko.

Ondoko taulan aurkituko dituzu kontsultagai gomendio batzuk zerbitzari konkurrenteen programaziorako. Adi datuari: zerbitzariaren kodea bitan banatzen da, harien klasea eta deia egingo dion nagusia bereiztearren; baina, batera ere egon litezke. Hots, fitxategi berdinean. Bestela, esan gabe doa norbere gida propioa sortzea sekula ez dagoela sobera, dena dela:

| Main (zerbitzaria)                                                                                | Thread (zerbitzaria)                                    | Bezeroa                                               |
| ------------------------------------------------------------------------------------------------- | ------------------------------------------------------- | ----------------------------------------------------- |
| Config Parameters                                                                                 | Get sockets for the connection and messages             | Connect to the server                                 |
| Accept connection(s), into a loop for example                                                     | Save if you are getting the rest of the object          | Prepare the input and output to the server            |
| Create a thread, will you save them?                                                              | Design the messages, the flags and so on, you will use. | Design the messages and the algorithm you will follow |
| Pass the socket object to the thread, will you need to save the objects?                          | Decide the order of the messages.                       | Create a universal code for all the clients           |
| Will you need shared resources? if so, instance the object and pass the object to the thread also |                                                         |                                                       |
| If you need shared resources, create a class to manage them, instance it and pass to the thread.  |                                                         |                                                       |

## &#x20;Zerbitzari konkurrenteen eskema generikoa

<figure><img src="../.gitbook/assets/Zerbitzari konkurrenteak.png" alt=""><figcaption></figcaption></figure>

## Zerbitzari konkurrentedun aplikazio baten adibidea

Hari anitzeko socketa darabiltzan aplikazio baten adibide xumea:

{% tabs %}
{% tab title="JavaScript" %}
```javascript
const message = "hello world";
console.log(message);
```
{% endtab %}

{% tab title="Python" %}
```python
message = "hello world"
print(message)
```
{% endtab %}

{% tab title="Ruby" %}
```ruby
message = "hello world"
puts message
```
{% endtab %}
{% endtabs %}

