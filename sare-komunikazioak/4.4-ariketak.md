# 4.4 Ariketak

{% hint style="danger" %}
**Gogoratu:** zerbitzaria beti aurrena exekutatzen!
{% endhint %}

## Ariketa gidatuak

1. Erantsitako kodeak ulertzen saiatu, probatu terminal desberdinetan eta moldatu ondorengo baldintzetara. <mark style="background-color:blue;">Egin TCP eta UDP ereduan.</mark>
   * Sortu itzazu bi fitxategi berri _SocketTCP\_Zerbitzaria\_Zenbatzen.java_ eta _SocketTCP\_Bezeroa\_Zenbatzen.java_ izenekoak.
   * Zerbitzariak egingo duena:
     * n bezero jasoko ditu eta gero bukatu egingo du mezu bat pantailatik erakutsiaz.
     * Bezero bakoitzari zenbatgarren sartu den pasako dio zenbaki batekin.
   * Bezeroak egingo duena:
     * Zerbitzarira konektatu eta honek bidaltzen dion zenbakiarekin "n.garren bezeroa naiz" mezua bistaratuko du eta bukatu egingo da.

{% tabs %}
{% tab title="SocketTCP_Zerbitzaria.java" %}
```javascript
package unieibar;

import java.io.IOException;
import java.net.*;

public class SocketTCP_Zerbitzaria {

	public static void main(String[] args) throws IOException {
		int port = 6000;
		ServerSocket zerbitzaria = new ServerSocket(port);
		System.out.println("Socket TCP ZERBITZARIA " + zerbitzaria.getLocalPort() + " portutik entzuten.");
		Socket bezeroa1 = zerbitzaria.accept(); // 1. bezeroa
		// bezeroarekin komunikatu eta ekintzak burutu
		System.out.println("1. bezeroa konektatu da!");
		System.out.println("bezeroa1.getPort(): " + bezeroa1.getPort());
		System.out.println("bezeroa1.getLocalPort(): " + bezeroa1.getLocalPort());
		System.out.println("bezeroa1.close()");
		bezeroa1.close();
		Socket bezeroa2 = zerbitzaria.accept(); // 2. bezeroa
		// bezeroarekin komunikatu eta ekintzak burutu
		System.out.println("2. bezeroa konektatu da!");
		System.out.println("bezeroa2.getPort(): " + bezeroa2.getPort());
		System.out.println("bezeroa2.getLocalPort(): " + bezeroa2.getLocalPort());
		System.out.println("bezeroa2.close()");
		bezeroa2.close();
		System.out.println("Socket TCP ZERBITZARIA itzalita. Agur!");
		zerbitzaria.close();
	}
}
```
{% endtab %}

{% tab title="SocketTCP_Bezeroa.java" %}
```java
package unieibar;

import java.net.*;

public class SocketTCP_Bezeroa {

	public static void main(String[] args) throws Exception {
		String host = "localhost";
		int port = 6000;

		//Socket-a ireki
		Socket bezeroa = new Socket(host, port);

		InetAddress inAddr = bezeroa.getInetAddress();
		System.out.println("bezeroa.getLocalPort() dela lokalekoa: " + bezeroa.getLocalPort());
		System.out.println("bezeroa.getPort() dela urrutikoa: " + bezeroa.getPort());
		System.out.println("inAddr.getHostName().toString() dela urrutiko zerbitzaria: " + inAddr.getHostName().toString());
		System.out.println("inAddr.getHostAddress().toString() dela urrutiko zerbitzariaren IP: " + inAddr.getHostAddress().toString()); // IP HOST REMOTO
		Thread.sleep(2000);
		bezeroa.close(); // socket-a itxi
	}
}
```
{% endtab %}
{% endtabs %}

## Ariketa aurreratuak

Sortu TCP eta UDP bertsio bana ariketan kontrakorik zehazten ez baldin bada.

1. Sortu bezero bakoitza konektatzean agurtuko duen zerbitzaria, eta, hark, zerbitzariari agur pertsonalizatu batekin erantzutea. <mark style="background-color:blue;">Egin UDP ereduan</mark> (TCPkoa [adibide](4.1-tcp.md) gisa emanda dago).
2. Bezeroagandik zenbaki bat jasoko duen zerbitzari bat sortu. Gero, zerbitzariak ausazko zenbakia batuko dio bezeroari itzuli.
3. Bezeroaren izena testu gisa eta adina zenbaki gisa (int) jasoko duen zerbitzaria sortu. Zerbitzariak, orduan, bezeroa adingabe den erantzun beharko du. Adibidez: "Jonek 17 urte ditu, adingabea da".
4. Programa bat sortu bezeroak "Ikaslea" motako objektu bat (`int id, izena, int adina, float eskolaraDistantzia`) bidaliko duena zerbitzarira. Bezeroak parametroak beteta bidaliko dizkio zerbitzariari, `id` izan ezik. Zerbitzariak objektua jasotzen duenean, `id` berria esleituko dio eta objektua bezeroari itzuliko. Bezeroak datu guztiak erakutsiko ditu kontsolan.
